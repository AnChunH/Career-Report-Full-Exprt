<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>ğŸ¯ ç”Ÿæ¶¯è¦åŠƒå ±å‘Š I+IIï¼ˆå®Œæ•´ç‰ˆï¼‰</title>
  <style>
    body { font-family: 'Microsoft JhengHei', sans-serif; padding: 30px; background: #f4f6f8; }
    h1, h2 { color: #2c3e50; }
    label { display: block; margin-top: 15px; font-weight: bold; }
    input[type=text], textarea, select {
      width: 100%; padding: 10px; margin-top: 5px; border-radius: 5px; border: 1px solid #ccc;
    }
    textarea { min-height: 80px; }
    .section {
      background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); margin-bottom: 30px;
    }
    button {
      background-color: #27ae60; color: white; padding: 10px 20px; border: none;
      border-radius: 5px; cursor: pointer; font-size: 16px; margin-right: 10px;
    }
    button:hover { background-color: #1e8449; }
    .group-description, .group-links { font-size: 14px; color: #444; margin-top: 5px; }
  </style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.7.0/docx.umd.min.js">function saveDraft() {
  const inputs = document.querySelectorAll("input[type=text], textarea, select");
  const draft = {};
  inputs.forEach((el, i) => {
    if (el.multiple) {
      draft["multi_"+i] = Array.from(el.selectedOptions).map(o => o.value);
    } else {
      draft[i] = el.value;
    }
  });
  localStorage.setItem("career_draft", JSON.stringify(draft));
}

function loadDraft() {
  const saved = localStorage.getItem("career_draft");
  if (!saved) return;
  const confirmRestore = confirm("æ˜¯å¦è¼‰å…¥ä¸Šæ¬¡æœªå®Œæˆçš„å¡«å¯«å…§å®¹ï¼Ÿ");
  if (!confirmRestore) return;
  const data = JSON.parse(saved);
  const inputs = document.querySelectorAll("input[type=text], textarea, select");
  inputs.forEach((el, i) => {
    if (el.multiple && data["multi_"+i]) {
      Array.from(el.options).forEach(opt => {
        opt.selected = data["multi_"+i].includes(opt.value);
      });
      showGroupTooltip(el);
    } else if (data[i]) {
      el.value = data[i];
    }
  });
  updateSuggestion();
}

function clearDraft() {
  localStorage.removeItem("career_draft");
  alert("å·²æ¸…é™¤è‰ç¨¿ï¼è«‹é‡æ–°æ•´ç†é é¢ã€‚");
}

setInterval(saveDraft, 5000);
window.addEventListener("DOMContentLoaded", loadDraft);

async function downloadWord() {
  const { Document, Packer, Paragraph, TextRun } = window.docx;
  const inputs = document.querySelectorAll("input[type=text], textarea, select");
  const doc = new Document();
  const children = [];

  const today = new Date().toLocaleDateString('zh-TW');
children.push(new Paragraph({ children: [new TextRun({ text: "ğŸ¯ ç”Ÿæ¶¯è¦åŠƒå ±å‘Š I+II", bold: true, size: 28 })] }));
children.push(new Paragraph({ children: [new TextRun({ text: `ğŸ“… è¼¸å‡ºæ—¥æœŸï¼š${today}`, italics: true })] }));
children.push(new Paragraph(""));
children.push(new Paragraph("è¦ªæ„›çš„åŒå­¸ï¼š"));
children.push(new Paragraph("é«˜ä¸€ä¸‹å­¸æœŸå³å°‡é€²å…¥å°¾è²ï¼Œé€™æ®µæ™‚é–“ä½ åœ¨å„é …èª²ç¨‹ã€ç¤¾åœ˜ã€æ´»å‹•ä¸­ä¸æ–·å˜—è©¦ã€å­¸ç¿’ï¼Œä¹Ÿæ…¢æ…¢ç´¯ç©èµ·å±¬æ–¼è‡ªå·±çš„ç¶“é©—èˆ‡æ•…äº‹ã€‚"));
children.push(new Paragraph("ç¾åœ¨ï¼Œæ˜¯å€‹å¾ˆå¥½çš„æ™‚æ©Ÿï¼Œè«‹ä½ åœä¸‹ä¾†å›æœ›éå»ï¼Œä»”ç´°ç›¤é»é€™ä¸€å¹´ä¾†çš„å­¸ç¿’æ­·ç¨‹ã€‚é€éå…·é«”çš„å›é¡§èˆ‡æ›¸å¯«ï¼Œä½ å°‡æ›´æ¸…æ¥šè‡ªå·±æ“…é•·ä»€éº¼ã€å–œæ­¡ä»€éº¼ã€æƒ³åŠ å¼·ä»€éº¼ï¼Œä¹Ÿèƒ½ç‚ºé«˜äºŒåšå‡ºæ›´æœ‰æ–¹å‘çš„æº–å‚™ã€‚"));
children.push(new Paragraph("æœ¬å ±å‘Šä¸åªæ˜¯å¡«ç©ºï¼Œè€Œæ˜¯ä¸€å€‹ä½ èˆ‡è‡ªå·±å°è©±çš„æ©Ÿæœƒã€‚è«‹ä½ èªçœŸã€èª æ‡‡åœ°å®Œæˆæ¯ä¸€å€‹æ¬„ä½ï¼Œå®ƒå°‡æˆç‚ºä½ å­¸ç¿’æ­·ç¨‹æª”æ¡ˆä¸­å¯¶è²´çš„ä¸€é ï¼Œä¹Ÿå¹«åŠ©ä½ åœ¨æœªä¾†ç”³è«‹å¤§å­¸ã€æ¢ç´¢ç”Ÿæ¶¯æ™‚ï¼Œæ›´åŠ æœ‰æ“šå¯ä¾ã€æœ‰è©±å¯èªªã€‚"));
children.push(new Paragraph("åŠ æ²¹ï¼Œæˆ‘å€‘æœŸå¾…åœ¨æ–‡å­—ä¸­çœ‹è¦‹æ›´æ¸…æ™°çš„ä½ ã€‚"));
children.push(new Paragraph(""));

  const studentClass = document.getElementById("studentClass").value.trim();
  const studentName = document.getElementById("studentName").value.trim();
  const reportDate = document.getElementById("reportDate").value.trim();
  children.push(new Paragraph(`ğŸ“˜ ç­ç´šï¼š${studentClass}`));
  children.push(new Paragraph(`ğŸ“Œ å§“åï¼š${studentName}`));
  children.push(new Paragraph(`ğŸ“… æ—¥æœŸï¼š${reportDate}`));

  inputs.forEach((el, i) => {
    if (["studentClass", "studentName", "reportDate"].includes(el.id)) return;
    const label = el.previousElementSibling?.innerText?.trim() || `æ¬„ä½ ${i+1}`;
    let value = "";
    if (el.tagName === "SELECT" && el.multiple) {
      value = Array.from(el.selectedOptions).map(o => o.value).join(", ");
    } else {
      value = el.value.trim();
    }
    children.push(new Paragraph({ spacing: { before: 200 }, children: [new TextRun({ text: `ã€${label}ã€‘`, bold: true })] }));
    children.push(new Paragraph(value));
  });

  const docFile = new Document({ sections: [{ properties: {}, children }] });
  const blob = await Packer.toBlob(docFile);
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = `ç”Ÿæ¶¯è¦åŠƒå ±å‘Š_${studentName || "æœªå‘½å"}.docx`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}
</script>
</head>
<body>
  <div class="section">
  <p style="font-size: 16px; color: #333; line-height: 1.6;">
    è¦ªæ„›çš„åŒå­¸ï¼š<br><br>
    é«˜ä¸€ä¸‹å­¸æœŸå³å°‡é€²å…¥å°¾è²ï¼Œé€™æ®µæ™‚é–“ä½ åœ¨å„é …èª²ç¨‹ã€ç¤¾åœ˜ã€æ´»å‹•ä¸­ä¸æ–·å˜—è©¦ã€å­¸ç¿’ï¼Œä¹Ÿæ…¢æ…¢ç´¯ç©èµ·å±¬æ–¼è‡ªå·±çš„ç¶“é©—èˆ‡æ•…äº‹ã€‚<br><br>
    ç¾åœ¨ï¼Œæ˜¯å€‹å¾ˆå¥½çš„æ™‚æ©Ÿï¼Œè«‹ä½ åœä¸‹ä¾†å›æœ›éå»ï¼Œä»”ç´°ç›¤é»é€™ä¸€å¹´ä¾†çš„å­¸ç¿’æ­·ç¨‹ã€‚é€éå…·é«”çš„å›é¡§èˆ‡æ›¸å¯«ï¼Œä½ å°‡æ›´æ¸…æ¥šè‡ªå·±æ“…é•·ä»€éº¼ã€å–œæ­¡ä»€éº¼ã€æƒ³åŠ å¼·ä»€éº¼ï¼Œä¹Ÿèƒ½ç‚ºé«˜äºŒåšå‡ºæ›´æœ‰æ–¹å‘çš„æº–å‚™ã€‚<br><br>
    æœ¬å ±å‘Šä¸åªæ˜¯å¡«ç©ºï¼Œè€Œæ˜¯ä¸€å€‹ä½ èˆ‡è‡ªå·±å°è©±çš„æ©Ÿæœƒã€‚è«‹ä½ èªçœŸã€èª æ‡‡åœ°å®Œæˆæ¯ä¸€å€‹æ¬„ä½ï¼Œå®ƒå°‡æˆç‚ºä½ å­¸ç¿’æ­·ç¨‹æª”æ¡ˆä¸­å¯¶è²´çš„ä¸€é ï¼Œä¹Ÿå¹«åŠ©ä½ åœ¨æœªä¾†ç”³è«‹å¤§å­¸ã€æ¢ç´¢ç”Ÿæ¶¯æ™‚ï¼Œæ›´åŠ æœ‰æ“šå¯ä¾ã€æœ‰è©±å¯èªªã€‚<br><br>
    åŠ æ²¹ï¼Œæˆ‘å€‘æœŸå¾…åœ¨æ–‡å­—ä¸­çœ‹è¦‹æ›´æ¸…æ™°çš„ä½ ã€‚
  </p>
</div>
  <h1>ğŸ¯ ç”Ÿæ¶¯è¦åŠƒå ±å‘Š I+IIï¼ˆå®Œæ•´ç‰ˆï¼‰</h1>

  <div class="section">
    <label>ğŸ“˜ ç­ç´šï¼š</label><input type="text" id="studentClass" required>
    <label>ğŸ“Œ å§“åï¼š</label><input type="text" id="studentName" required>
    <label>ğŸ“… æ—¥æœŸï¼š</label><input type="text" id="reportDate" placeholder="ä¾‹å¦‚ï¼š2025/06/01" required>
  </div>

  <div class="section">
    <h2>ğŸ§  ç¬¬ä¸€éƒ¨åˆ†ï¼šå­¸ç¿’æ­·ç¨‹å›é¡§</h2>
    <label>ä½ æ›¾ç‚ºä»€éº¼ç›®æ¨™åŠªåŠ›ï¼Ÿ</label><textarea required></textarea>
    <label>ä½ æœ€æœ‰æˆå°±æ„Ÿçš„ä¸€ä»¶äº‹ï¼ˆå­¸ç¿’ï¼‰æ˜¯ä»€éº¼ï¼Ÿ</label><textarea required></textarea>
    <label>ä½ è¦ºå¾—è‡ªå·±æ¯”è¼ƒé©åˆå“ªç¨®å­¸ç¿’æ–¹å¼ï¼Ÿç†è«– / å¯¦ä½œ / å‰µä½œï¼Ÿ</label><textarea required></textarea>
    <label>å“ªå€‹ç¶“é©—è®“ä½ è¦ºå¾—è‡ªå·±é©åˆæŸå€‹é ˜åŸŸï¼Ÿ</label><textarea required></textarea>
  </div>

  <div class="section">
    <h2>ğŸ“˜ ç¬¬äºŒéƒ¨åˆ†ï¼šå­¸ç¿’æ­·ç¨‹ç›¤é»ï¼ˆä¹å¤§é …ï¼‰</h2>
    <div id="dynamicFields"></div>
  </div>

  <div class="section">
    <h2>ğŸ¯ ç¬¬ä¸‰éƒ¨åˆ†ï¼šé«˜äºŒç™¼å±•è¨ˆç•«</h2>
    <label>æˆ‘éœ€è¦åŠ å¼·çš„éƒ¨åˆ†ï¼š</label><textarea required></textarea>
    <label>æ–°å¢çš„è‡ªä¸»å­¸ç¿’èˆ‡æ´»å‹•è¨ˆç•«ï¼š</label><textarea required></textarea>
    <label>é è¨ˆåƒèˆ‡çš„èª²å¤–æ´»å‹•èˆ‡è¨ˆç•«ï¼š</label><textarea required></textarea>
    <label>å¸Œæœ›é«˜äºŒèƒ½é”æˆçš„ç›®æ¨™ï¼š</label><textarea required></textarea>
  </div>

  <div class="section">
    <h2>ğŸ“ ç¬¬å››éƒ¨åˆ†ï¼šå‡å­¸æ–¹å‘è¦åŠƒ</h2>
    <label>èˆˆè¶£å­¸ç¾¤ï¼š</label><textarea required></textarea>
    <label>å¯èƒ½é¸æ“‡çš„ç§‘ç³»ï¼š</label><textarea required></textarea>
    <label>æ‰€éœ€è£œå¼·ä¹‹å­¸ç¿’æ­·ç¨‹é …ç›®ï¼š</label><textarea required></textarea>
  </div>

  <div class="section">
    <h2>âœ çµèªåæ€</h2>
    <label>ä½ å¾é€™æ¬¡å›é¡§ä¸­å¾—åˆ°çš„é«”æ‚Ÿï¼š</label><textarea required></textarea>
    <label>ä½ å¸Œæœ›æ¥ä¸‹ä¾†çš„å­¸ç¿’ç‹€æ…‹èˆ‡åŠªåŠ›æ–¹å‘æ˜¯ï¼š</label><textarea required></textarea>
  </div>

  <div class="section">
    <h2>ğŸ¤– AI æ¨è–¦å­¸ç¾¤ï¼ˆä¾å¡«å¯«å…§å®¹è‡ªå‹•é æ¸¬ï¼‰</h2>
    <div id="ai-suggestion">ï¼ˆè«‹å…ˆå¡«å¯«ä¸Šæ–¹å…§å®¹ï¼Œæœ¬å€å°‡è‡ªå‹•ç”¢ç”Ÿå»ºè­°å­¸ç¾¤ï¼‰</div>
  </div>

  <button onclick="downloadReport()">ğŸ’¾ ä¸‹è¼‰å¡«å¯«çµæœ (.txt)</button>
  <button onclick="downloadWord()">ğŸ“ ä¸‹è¼‰ Word æª” (.docx)</button>
  <button onclick="clearDraft()">ğŸ—‘ æ¸…é™¤è‰ç¨¿</button>

  <script>
    const fieldTitles = [
      "å­¸ç§‘å­¸ç¿’", "è·¨é ˜åŸŸå­¸ç¿’", "å­¸ç§‘ç«¶è³½", "è‡ªä¸»å­¸ç¿’", "ç§‘å­¸è¬›åº§èˆ‡è«–å£‡",
      "å¿—å·¥èˆ‡ç¤¾æœƒæœå‹™", "ç¤¾åœ˜èˆ‡é ˜å°æ´»å‹•", "ä½œå“èˆ‡å°ˆé¡Œå ±å‘Š", "æœªä¾†å­¸ç¿’ç›®æ¨™"
    ];

    const studyGroups = [
      ["æ•¸ç†åŒ–å­¸å­¸ç¾¤", "è‘—é‡æ•¸å­¸èˆ‡è‡ªç„¶ç§‘å­¸åŸç†ï¼ŒåŒ…å«æ•¸å­¸ç³»ã€åŒ–å­¸ç³»ã€ç‰©ç†ç³»ç­‰"],
      ["å·¥ç¨‹å­¸ç¾¤", "å¼·èª¿å·¥ç¨‹å¯¦ä½œèˆ‡æ‡‰ç”¨ï¼ŒåŒ…å«æ©Ÿæ¢°ã€é›»æ©Ÿã€åœŸæœ¨ã€ç”Ÿé†«å·¥ç¨‹ç­‰"],
      ["è³‡è¨Šå­¸ç¾¤", "æ¢è¨é›»è…¦ç§‘å­¸èˆ‡è³‡æ–™è™•ç†ï¼ŒåŒ…å«è³‡å·¥ã€è³‡ç®¡ã€AI ç­‰"],
      ["ç”Ÿç‰©è³‡æºå­¸ç¾¤", "èšç„¦å‹•æ¤ç‰©ã€è¾²æ¥­èˆ‡ç’°å¢ƒï¼ŒåŒ…å«è¾²è—ã€ç”ŸæŠ€ã€æ£®æ—ç­‰"],
      ["ç”Ÿå‘½ç§‘å­¸å­¸ç¾¤", "ç ”ç©¶ç”Ÿå‘½ç¾è±¡ï¼ŒåŒ…å«ç”Ÿç§‘ã€ç”Ÿé†«ã€ç”ŸåŒ–ã€åŸºå› é«”ç­‰"],
      ["é†«è—¥è¡›ç”Ÿå­¸ç¾¤", "æ¶µè“‹é†«å­¸ã€è—¥å­¸ã€è­·ç†ã€å…¬è¡›ç­‰å¥åº·é ˜åŸŸ"],
      ["åœ°çƒèˆ‡ç’°å¢ƒå­¸ç¾¤", "æ¢è¨åœ°çƒç³»çµ±èˆ‡æ°¸çºŒç™¼å±•ï¼ŒåŒ…å«åœ°ç§‘ã€ç’°å·¥ã€æµ·æ´‹ç­‰"],
      ["è¨­è¨ˆå­¸ç¾¤", "å¼·èª¿å‰µæ„èˆ‡å¯¦ä½œï¼ŒåŒ…å«å·¥è¨­ã€è¦–å‚³ã€å»ºç¯‰ã€æ™‚å°šç­‰"],
      ["è—è¡“å­¸ç¾¤", "è—è¡“å‰µä½œèˆ‡è¡¨æ¼”ç›¸é—œï¼ŒåŒ…å«ç¾è¡“ã€éŸ³æ¨‚ã€æˆ²åŠ‡ã€èˆè¹ˆç­‰"],
      ["ç¤¾æœƒèˆ‡å¿ƒç†å­¸ç¾¤", "ç ”ç©¶äººé¡è¡Œç‚ºèˆ‡ç¤¾æœƒç³»çµ±ï¼ŒåŒ…å«ç¤¾æœƒã€å¿ƒç†ã€äººé¡å­¸ç­‰"],
      ["äººæ–‡ç¤¾æœƒå­¸ç¾¤", "æ¢è¨æ­·å²ã€å“²å­¸èˆ‡èªæ–‡ï¼ŒåŒ…å«ä¸­æ–‡ã€å¤–æ–‡ã€æ­·å²ã€å“²å­¸ç­‰"],
      ["æ³•æ”¿å­¸ç¾¤", "æ¶‰åŠæ³•å¾‹èˆ‡æ”¿æ²»åˆ¶åº¦ï¼ŒåŒ…å«æ³•å¾‹ã€æ”¿æ²»ã€å¤–äº¤ç­‰"],
      ["è²¡ç¶“ç®¡ç†å­¸ç¾¤", "ç¶“æ¿Ÿé‹ä½œèˆ‡ä¼æ¥­ç¶“ç‡Ÿï¼ŒåŒ…å«æœƒè¨ˆã€è²¡é‡‘ã€ä¼ç®¡ã€è¡ŒéŠ·ç­‰"],
      ["æ•™è‚²å­¸ç¾¤", "æ•™å­¸èˆ‡å¸«è³‡é¤Šæˆç›¸é—œï¼ŒåŒ…å«æ•™è‚²ã€å¹¼æ•™ã€ç‰¹æ•™ç­‰"],
      ["å…¶ä»–å­¸ç¾¤", "ä¸å±¬ä¸Šè¿°åˆ†é¡ï¼Œå¦‚é«”è‚²ã€è»è­¦ã€èªè¨€ç­‰"]
    ];

    const dyn = document.getElementById("dynamicFields");
    fieldTitles.forEach(title => {
      const options = studyGroups.map(([label, desc]) => `<option value="${label}" title="${desc}">${label}</option>`).join("");
      dyn.innerHTML += `
        <div class="sub">
          <h3>ğŸ”¹ ${title}</h3>
          <label>ç›®å‰æˆæœï¼š</label><textarea required></textarea>
          <label>å­¸ç¿’æ­·ç¨‹ç´€éŒ„ï¼š</label><textarea required></textarea>
          <label>è£œå¼·è¨ˆç•«ï¼š</label><textarea required></textarea>
          <label>å°æ‡‰å­¸ç¾¤ï¼šï¼ˆå¯å¤šé¸ï¼Œè«‹æŒ‰ä½ Ctrl æˆ– âŒ˜ éµï¼‰</label>
          <select required multiple size="5" onchange="showGroupTooltip(this)">${options}</select>
          <div class="group-description"></div>
          <div class="group-links"></div>
        </div>
      `;
    });

    function showGroupTooltip(select) {
      const descDiv = select.nextElementSibling;
      const linkDiv = descDiv.nextElementSibling;
      const selected = Array.from(select.selectedOptions);
      const tips = selected.map(option => `â€¢ ${option.value}: ${option.title}`);
      const links = selected.map(option => `ğŸ” è«‹è‡³ ColleGo! æœå°‹ã€Œ${option.value}ã€ç›¸é—œç§‘ç³»`);
      descDiv.innerHTML = tips.length ? tips.join('<br>') : '(å°šæœªé¸æ“‡å­¸ç¾¤)';
      linkDiv.innerHTML = links.length ? links.join('<br>') : '';
    }

    document.querySelectorAll('select[multiple]').forEach(select => {
      const notice = document.createElement('div');
      notice.style.color = 'gray';
      notice.style.fontSize = '14px';
      notice.textContent = 'ï¼ˆå·²é¸æ“‡ 0 / æœ€å¤š 3 å€‹ï¼‰';
      select.after(notice);
      select.addEventListener('change', () => {
        const count = Array.from(select.selectedOptions).length;
        notice.textContent = `ï¼ˆå·²é¸æ“‡ ${count} / æœ€å¤š 3 å€‹ï¼‰`;
        if (count > 3) {
          alert('æœ€å¤šåªèƒ½é¸æ“‡ 3 å€‹å­¸ç¾¤ï¼');
        }
      });
    });

    function downloadReport() {
      const fields = document.querySelectorAll("textarea, input[type=text], select");
      let content = "ğŸ¯ ç”Ÿæ¶¯è¦åŠƒå ±å‘Š I+II å¡«å¯«å…§å®¹å¦‚ä¸‹ï¼š\n\n";
      const studentClass = document.getElementById("studentClass").value.trim();
      const studentName = document.getElementById("studentName").value.trim();
      const reportDate = document.getElementById("reportDate").value.trim();
      content += `ğŸ“˜ ç­ç´šï¼š${studentClass}\nğŸ“Œ å§“åï¼š${studentName}\nğŸ“… æ—¥æœŸï¼š${reportDate}\n\n`;

      fields.forEach((el, i) => {
        if (["studentName", "studentClass", "reportDate"].includes(el.id)) return;
        const label = el.previousElementSibling?.innerText?.trim() || `æ¬„ä½ ${i + 1}`;
        let value = "";
        if (el.tagName === "SELECT" && el.multiple) {
          value = Array.from(el.selectedOptions).map(opt => opt.value).join(", ");
        } else {
          value = el.value.trim();
        }
        content += `ã€${label}ã€‘\n${value}\n\n`;
      });

      const blob = new Blob([content], { type: "text/plain;charset=utf-8" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = `ç”Ÿæ¶¯è¦åŠƒå ±å‘Š_${studentName || "æœªå‘½å"}.txt`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    function extractTextInputs() {
      return Array.from(document.querySelectorAll("textarea")).map(a => a.value.toLowerCase()).join(" ");
    }
    function suggestGroups(text) {
      const keywords = {
        "è³‡è¨Š": "è³‡è¨Šå­¸ç¾¤",
        "ç¨‹å¼": "è³‡è¨Šå­¸ç¾¤",
        "æ•¸å­¸": "æ•¸ç†åŒ–å­¸å­¸ç¾¤",
        "å¯¦é©—": "ç”Ÿå‘½ç§‘å­¸å­¸ç¾¤",
        "ç”Ÿç‰©": "ç”Ÿå‘½ç§‘å­¸å­¸ç¾¤",
        "é†«": "é†«è—¥è¡›ç”Ÿå­¸ç¾¤",
        "ç’°å¢ƒ": "åœ°çƒèˆ‡ç’°å¢ƒå­¸ç¾¤",
        "å‰µä½œ": "è—è¡“å­¸ç¾¤",
        "ç¹ªåœ–": "è¨­è¨ˆå­¸ç¾¤",
        "å¿ƒç†": "ç¤¾æœƒèˆ‡å¿ƒç†å­¸ç¾¤",
        "æ•™å­¸": "æ•™è‚²å­¸ç¾¤",
        "ç¶“æ¿Ÿ": "è²¡ç¶“ç®¡ç†å­¸ç¾¤",
        "æ³•å¾‹": "æ³•æ”¿å­¸ç¾¤"
      };
      const result = new Set();
      for (const [k, group] of Object.entries(keywords)) {
        if (text.includes(k)) result.add(group);
      }
      return [...result];
    }
    function updateSuggestion() {
      const raw = extractTextInputs();
      const matched = suggestGroups(raw);
      const container = document.getElementById("ai-suggestion");
      if (matched.length === 0) {
        container.innerHTML = "ï¼ˆå°šæœªæ‰¾åˆ°æ˜ç¢ºçš„æ¨è–¦ï¼Œè«‹å¡«å¯«æ›´å¤šå…§å®¹ï¼‰";
      } else {
        const query = matched.join(' ');
container.innerHTML = "ğŸ” æ ¹æ“šä½ çš„å¡«å¯«ï¼Œä»¥ä¸‹å­¸ç¾¤å¯èƒ½èˆ‡ä½ ç›¸ç¬¦ï¼š<ul>" +
  matched.map(g => `<li>${g}ï¼ˆè«‹è‡³ ColleGo! æœå°‹è©²å­¸ç¾¤ï¼‰</li>`).join("") +
  "</ul><br><a href='https://www.google.com/search?q=site:collego.edu.tw+" + encodeURIComponent(query) + "' target='_blank'>ğŸ” åœ¨ ColleGo! æœå°‹é€™äº›å­¸ç¾¤</a>";
      }
    }
    document.querySelectorAll("textarea").forEach(el => {
      el.addEventListener("input", () => setTimeout(updateSuggestion, 300));
    });
  </script>
</body>
</html>
